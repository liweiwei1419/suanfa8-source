---
title: 树形 DP 简介
icon: yongyan
categories: 动态规划
tags:
  - 动态规划
  - 树形 DP
---

![输入图片说明](https://tva1.sinaimg.cn/large/008i3skNgy1gxixq2edeij30r00ai0t3.jpg "屏幕截图.png")

今天要和大家分享的是「树形 DP」，也就是在树的问题上进行「动态规划」。

先说结论。如果一个树的问题和树当中的路径相关，只问最优值，并不问这个最优值是怎么来的，那么这样的问题很可能需要使用动态规划的思想解决。

具体来说会用到以下两个思想：

+ 后序遍历：树的问题很多时候需要遍历，而后序遍历有这样的特点：从叶子结点开始一层一层向上汇报；
+ 无后效性：无后效性是动态规划的思想，即我们在求解原问题的时候，把问题分成若干个 **有重叠部分** 的子问题，求解这些子问题的时候，一旦子问题得到结果，后面的求解过程不会再更改它。


> 「无后效性」是一个在我看来很难用文字解释清楚的概念，**需要有一定的做题的经验**，并且在脑海里有这样一个印象：动态规划求解问题的过程够成了一张有向无环图。

> 动态规划的无后效性的应用主要有 2 点：
>
> + 给状态数组增加维度：因为记录了更多的信息，让需要分类讨论的问题变得更简单，即状态转移方程容易得到；
> + 如果一件事情不确定，设计状态的时候，我们就需要固定住这件事情，例如非常经典的动态规划问题「最长上升子序列」（「力扣」第 300 题），「子序列」对于输入数组而言，中每一个元素有可能被选择，也有可能不被选择，我们在设计状态的时候，设计成 `dp[i]` 表示以 `nums[i]` 结尾的最长上升子序列的长度，就是固定住了 `nums[i]` 必须被选择，以及必须以它结尾这件事情。

上面的描述很理论化，大家不妨先有个印象。

树形 DP 的入门问题是「打家劫舍」系列的第 3 题（「力扣」第 337 题），这个问题通常被包装成为「没有上司的舞会」，还蛮有意思的，大家可以在网上搜索一下。

我们今天要和大家分享的是「力扣」第 124 题：二叉树中的最大路径和。这道题看起来和「动态规划」没有什么关系，但事实上，解决它需要用到动态规划的思想，也就是应用了：无后效性。