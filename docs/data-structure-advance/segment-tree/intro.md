---
title: 线段树北美讲题大纲
icon: yongyan
category: 线段树
tags:
  - 线段树
---

北美讲题大纲

## 线段树入门

时间：2020 年 6 月 6 日

- 只介绍「线段树」基础知识，不做深入讨论；
- 参考资料：liuyubobobo 老师的 GitHub [《玩转数据结构》代码仓库](https://github.com/liuyubobobo/Play-with-Data-Structures/tree/master/09-Segment-Tree)。

为什么介绍线段树？谷歌公司要考，它思想简单，代码实现有一点复杂。

------

## 1. 前置知识：前缀和数组

- `preSum[i]` 表示 `nums[0..i]` 里全部元素的和（一个数代表了原始数组的一个前缀区间的和）；
- 前缀和数组，就是一堆前缀和，可以用于：**快速计算区间和**（查询区间和 O(1)O(1)O(1)）；
- 区间 `[i..j]` 的和： `preSum[j] - preSum[i - 1]`。

------

Java 代码：

```
int len = nums.length;
// 计算前缀和数组
int[] preSum = new int[len + 1];
preSum[0] = 0;

for (int i = 0; i < len; i++) {
  preSum[i + 1] = preSum[i] + nums[i];
}
```

- **缺点：前缀和数组，在有更新需求的前提下，不能高效地工作。**

------

## 2. 线段树

### 2.1 线段树的用途

线段树只回答了以下两个问题，不回答区间里有「删除」和「添加」操作的场景。

- 区间和查询
- 单点（区间）更新

------

### 2.2 前缀和数组与线段树都是原始数组的预处理数组

- 有了前缀和数组，就可以把原始数组丢弃了；
- 有了线段树（数组），也可以把原始数组丢弃了。

可以认为都是对原始数组的预处理数组，把一些需要用到的值提前计算出来，思想：空间换时间。

------

### 2.3 如何构建线段树、如何实现区间查询、如何实现区间更新

------

### 2.4 线段树总结（与已有知识的联系）

- 线段树一定是二叉树，是平衡二叉树，最后一层不满；
- 线段树不是完全二叉树、更不是满二叉树；
- **树可以建立在数组上**：① 并查集； ② 堆 （完全二叉树、满二叉树）；
- 后序遍历构建二叉树；
- 递归、分治、深度优先遍历；
- 前缀和预处理的思路是：线性结构；线段树预处理的思路是：树结构。

------

### 2.5 练习

- 「力扣」第 307 题： [区域和检索 - 数组可修改](https://leetcode-cn.com/problems/range-sum-query-mutable/)；
- 其它「力扣」上标签为「线段树」（segment-tree）的问题。

------

### 2.6 扩展

- 区间更新：懒加载策略；
- 树状数组（回答前缀和、单点（区间）更新）
- 线段树 >= 树状数组（binary-indexed-tree）